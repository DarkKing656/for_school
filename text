char* find_matching_substring(const char* big_str, const char* small_str, int case_insensitive, size_t max_length) {
    // Получаем длины строк
    size_t big_len = strlen(big_str);
    size_t small_len = strlen(small_str);
  
    // Проверяем, что размерный маленькой строки меньше или равен длине большой строки
    if (small_len <= big_len) {
        // Выполняем сравнение с учетом регистра или без него в зависимости от значения case_insensitive
        int match_found = 0;
        if (case_insensitive) {
            match_found = strcasestr(big_str, small_str) != NULL;
        } else {
            match_found = strstr(big_str, small_str) != NULL;
        }
      
        // Если совпадение найдено, возвращаем найденную подстроку
        if (match_found) {
            char* found_substring = strstr(big_str, small_str);
            size_t found_len = strlen(found_substring);
            size_t copy_len = (found_len < max_length) ? found_len : max_length - 1;
            char* result = malloc(copy_len + 1);
            strncpy(result, found_substring, copy_len);
            result[copy_len] = '\0';
            return result;
        }
    }
  
    return NULL;  // Возвращаем NULL, если совпадение не найдено или размерности строк некорректны
}
